#!/bin/bash

# –ü–æ—Ä–æ–≥ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (10%)
THRESHOLD=10

while true; do
  # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–π –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏
  BATTERY_STATUS=$(acpi -b)
  BATTERY_LEVEL=$(echo "$BATTERY_STATUS" | grep -P -o '[0-9]+(?=%)' | head -1)

  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –±–∞—Ç–∞—Ä–µ—è —Ä–∞–∑—Ä—è–∂–∞–µ—Ç—Å—è –∏ —É—Ä–æ–≤–µ–Ω—å –Ω–∏–∂–µ –ø–æ—Ä–æ–≥–∞
  if [[ $BATTERY_STATUS == *"Discharging"* ]] && [[ $BATTERY_LEVEL -le $THRESHOLD ]]; then
    notify-send -u critical "üîã –ù–∏–∑–∫–∏–π –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏!" "–û—Å—Ç–∞–ª–æ—Å—å ${BATTERY_LEVEL}% ‚Äî –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∑–∞—Ä—è–¥–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ!"
  fi

  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
  sleep 60
done
